# yamllint disable rule:braces
---
filebeat.inputs:

  - type: log
    paths:
      - "{{ LOG_FILE_DOOR_MONITOR }}*"
    fields:
      logzio_codec: json
      token: "{{ USER_CONFIG['LOGS']['LOGZ_IO']['LOGZ_IO_TOKEN'] }}"
      type: pi_portal_door_json
    fields_under_root: true
    encoding: utf-8
    ignore_older: 12h

  - type: log
    paths:
      - "{{ LOG_FILE_SLACK_BOT }}*"
      - "{{ LOG_FILE_SLACK_CLIENT }}*"
    fields:
      logzio_codec: json
      token: "{{ USER_CONFIG['LOGS']['LOGZ_IO']['LOGZ_IO_TOKEN'] }}"
      type: pi_portal_slack_json
    fields_under_root: true
    encoding: utf-8
    ignore_older: 12h

  - type: log
    paths:
      - "{{ LOG_FILE_TASK_SCHEDULER }}*"
    fields:
      logzio_codec: json
      token: "{{ USER_CONFIG['LOGS']['LOGZ_IO']['LOGZ_IO_TOKEN'] }}"
      type: pi_portal_tasks_json
    fields_under_root: true
    encoding: utf-8
    ignore_older: 12h

  - type: log
    paths:
      - "{{ LOG_FILE_TEMPERATURE_MONITOR }}*"
    fields:
      logzio_codec: json
      token: "{{ USER_CONFIG['LOGS']['LOGZ_IO']['LOGZ_IO_TOKEN'] }}"
      type: pi_portal_temperature_json
    fields_under_root: true
    encoding: utf-8
    ignore_older: 12h

# For version 7 and higher
filebeat.registry.path: /var/lib/filebeat

# The following processors are to ensure compatibility with version 7
processors:
  - rename:
      fields:
        - from: "agent"
          to: "beat_agent"
      ignore_missing: true
  - rename:
      fields:
        - from: "log.file.path"
          to: "source"
      ignore_missing: true

############################# Output ##########################################

output:
  logstash:
    hosts: ["listener.logz.io:5015"]
    ssl:
      certificate_authorities: ['/etc/pki/tls/certs/COMODORSADomainValidationSecureServerCA.crt']
